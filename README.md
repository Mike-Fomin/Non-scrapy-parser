# Requests AlkoTeka parser

Этот проект представляет собой Python-скрипт для сбора данных о товарах с сайта [AlkoTeka](https://alkoteka.com) через его публичный API. Скрипт извлекает подробную информацию о продуктах для указанного города (по умолчанию: Краснодар) и сохраняет результаты в JSON-файл. Используются асинхронные HTTP-запросы с поддержкой прокси для эффективной обработки большого объема запросов.

## Возможности
- **Асинхронные запросы**: Использует библиотеку `aiohttp` для параллельных HTTP-запросов, что повышает производительность.
- **Поддержка прокси**: Чередует прокси-серверы для обхода ограничений по скорости и блокировок по IP.
- **Контроль нагрузки**: Ограничивает количество одновременных запросов с помощью семафора.
- **Обработка ошибок**: Включает механизм повторных попыток при сбоях и подробное логирование.
- **Извлечение данных**: Собирает полную информацию о товарах.
- **Гибкость**: Поддерживает выбор города через UUID и настраиваемые входные URL.

## Требования
- **Python**: Версия 3.8 или выше.
- **Зависимости**: Установите необходимые пакеты с помощью:
  ```bash
  pip install aiohttp requests tqdm
  ```

## Установка
1. Склонируйте или скачайте репозиторий:
   ```bash
   git clone <URL-репозитория>
   cd <директория-репозитория>
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
   Или установите пакеты, указанные в **Требованиях**, вручную.

## Использование
1. Убедитесь, что файлы `input_urls.txt` и `proxy_http_ip.txt` заполнены корректными данными.
2. Запустите скрипт:
   ```bash
   python main.py
   ```
3. Скрипт выполнит следующее:
   - Прочитает URL категорий и прокси из входных файлов.
   - Соберет данные о товарах для указанного города (по умолчанию: Краснодар).
   - Сохранит результаты в файл `result2.json` в директории проекта.

## Результат
Результатом работы является JSON-файл (`result.json`), содержащий список словарей с данными о товарах. Каждый словарь включает:
- `timestamp`: Время сбора данных (в формате Unix timestamp).
- `RPC`: Артикул товара.
- `url`: Ссылка на страницу товара.
- `title`: Название товара с объемом (если применимо).
- `marketing_tags`: Список маркетинговых тегов.
- `brand`: Бренд товара.
- `section`: Иерархия категорий (родительская и дочерняя).
- `price_data`: Текущая цена, оригинальная цена и процент скидки.
- `stock`: Наличие и количество на складе.
- `assets`: Ссылка на основное изображение (другие типы медиа — заглушки).
- `metadata`: Описание товара и его характеристики.
- `variants`: Количество вариантов товара (по умолчанию: 1).


## Настройка
- **Выбор города**: Измените `city_id` в функции `main()` для сбора данных по другому городу. Поддерживаемые города и их UUID указаны в `CITIES_ID`:
  ```python
  CITIES_ID = {
      "Москва": "396df2b5-7b2b-11eb-80cd-00155d03900",
      "Краснодар": "4a70f9e0-46ae-11e7-83ff-00155d026416",
      "Ростов-на-Дону": "878a9eb4-46b2-11e7-83ff-00155d026416",
      "Сочи": "985b3eea-46b4-11e7-83ff-00155d026416"
  }
  ```
- **Параметры запросов**:
  - `semaphore`: Ограничивает количество одновременных запросов (по умолчанию: 10).
  - `tries`: Количество попыток повторного запроса при ошибке (по умолчанию: 3).
  - `sleep_timer`: Задержка между повторными попытками (по умолчанию: 3 секунды, увеличивается на 3 секунды).
  - `request_delay`: Задержка между запросами (по умолчанию: 0.2 секунды).
##
Проект разработан в рамках тестового задания на интервью.